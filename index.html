<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sesame Street Fever - Album Links</title>
<style>
@keyframes flashColors {
  0% { background-color: pink; }
  33% { background-color: yellow; }
  66% { background-color: orange; }
  100% { background-color: transparent; }
}

.flash-animation {
  animation: flashColors 1.5s ease forwards;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  pointer-events: none;
  z-index: 9999;
}

#reactionMessage {
  position: fixed;
  top: 20%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 12px 24px;
  border-radius: 10px;
  font-size: 1.2rem;
  z-index: 10000;
  display: none;
  user-select: none;
}

body {
  font-family: sans-serif;
  text-align: center;
  margin: 0;
  padding: 20px;
}

.main-header {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 20px;
  text-transform: uppercase;
  letter-spacing: 2px;
}

.image-frame {
  margin: 40px auto 0 auto;
  max-width: 300px;
  width: 100%;
  border: 4px solid #444;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  padding: 10px;
  background: white;
  border-radius: 8px;
}

.image-frame img {
  width: 100%;
  height: auto;
  border-radius: 4px;
}

#reactions {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin: 20px auto;
}

#reactions button {
  flex: 1 1 auto;
  min-width: 100px;
  padding: 12px 16px;
  font-size: 1rem;
  border-radius: 10px;
  border: none;
  cursor: pointer;
}

#commentBox {
  max-width: 90%;
  width: 400px;
  margin: 20px auto;
}

#commentList {
  height: 250px;
  overflow-y: auto;
  border: 1px solid #ccc;
  padding: 10px;
  border-radius: 8px;
  background: #f9f9f9;
}

#commentForm {
  margin-top: 10px;
  display: flex;
  flex-direction: column;
}

#commentForm input, #commentForm button {
  padding: 10px;
  margin-bottom: 8px;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-size: 1rem;
}

#commentForm button {
  background-color: #007bff;
  color: white;
  border: none;
}

/* Responsive Styles */
@media (max-width: 600px) {
  .main-header {
    font-size: 2rem;
  }
  h1 {
    font-size: 1.5rem;
  }
  #reactionMessage {
    font-size: 1rem;
    padding: 8px 16px;
  }
  #reactions {
    flex-direction: column;
    gap: 8px;
  }
  #reactions button {
    width: 100%;
    font-size: 1.1rem;
  }
  #commentList {
    height: 200px;
  }

}

.platform-links {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 20px 0;
}

.platform-links a {
  display: inline-block;
  padding: 12px 20px;
  border-radius: 30px;
  font-size: 1.1rem;
  font-weight: bold;
  text-decoration: none;
  color: white;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.platform-links a:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.spotify-btn {
  background: linear-gradient(135deg, #1DB954, #17a24a);
}

.ytmusic-btn {
  background: linear-gradient(135deg, #ff0000, #cc0000);
}

/* Mobile friendly */
@media (max-width: 600px) {
  .platform-links {
    flex-direction: column;
    align-items: stretch;
  }
  .platform-links a {
    text-align: center;
    font-size: 1.2rem;
  }
}
</style>
</head>
<body>
<div id="reactionMessage">Thanks for your reaction! üéâ</div>

<h2 class="main-header">Album of the Month</h2>
<h1>Sesame Street Fever</h1>
<div class="platform-links">
  <a href="https://open.spotify.com/album/0qmobJcPkvjFTucszTTpV0" target="_blank" class="spotify-btn">
    üéµ Listen on Spotify
  </a>
  <a href="https://music.youtube.com/playlist?list=OLAK5uy_lB960Xi34FT5foqWk4wDvfrBafAYCrMtc" target="_blank" class="ytmusic-btn">
    üì∫ Listen on YouTube Music
  </a>
</div>
<div class="image-frame">
  <img src="background.png" alt="Sesame Street Fever Album Art">
</div>

<h2 style="margin-top: 50px;">How do you feel about this album?</h2>
<div id="reactions">
  <button style="background:#ff4081;color:white;">üòç Adore (<span id="adoreCount">0</span>)</button>
  <button style="background:#ffca28;color:black;">üòê Meh (<span id="mehCount">0</span>)</button>
  <button style="background:#ef5350;color:white;">üòñ Bad (<span id="badCount">0</span>)</button>
</div>

<h2>Comments</h2>
<div id="commentBox">
  <div id="commentList"></div>
  <form id="commentForm">
    <input id="usernameInput" type="text" placeholder="Your name..." required />
    <input id="commentInput" type="text" placeholder="Write a comment..." required />
    <button type="submit">Send</button>
  </form>
</div>

 <script type="module">
 function flashScreenWithMessage(message) {
  const flash = document.createElement('div');
  flash.className = 'flash-animation';
  document.body.appendChild(flash);

  const msg = document.getElementById('reactionMessage');
  msg.textContent = message;
  msg.style.display = 'block';

  setTimeout(() => {
    msg.style.display = 'none';
    document.body.removeChild(flash);
  }, 1500); // match animation duration
}
document.getElementById('adoreBtn').onclick = () => flashScreenWithMessage('Adore');
document.getElementById('mehBtn').onclick = () => flashScreenWithMessage('Meh');
document.getElementById('badBtn').onclick = () => flashScreenWithMessage('Bad');

  // Firebase SDK v9 (Modular)
  import { increment } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
	  apiKey: "AIzaSyCA8_Q_0W9Mm3a62z9hc8eELR9BBEV2eDw",
	  authDomain: "albumofthemonth-39061.firebaseapp.com",
	  projectId: "albumofthemonth-39061",
	  storageBucket: "albumofthemonth-39061.firebasestorage.app",
	  messagingSenderId: "454136393557",
	  appId: "1:454136393557:web:323713330ce55e748c89dc",
	  measurementId: "G-DC217JZC6R"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const commentForm = document.getElementById("commentForm");
  const commentInput = document.getElementById("commentInput");
  const usernameInput = document.getElementById("usernameInput");
  const commentList = document.getElementById("commentList");

  // Load saved username
  window.addEventListener("load", () => {
    const savedName = localStorage.getItem("username");
    if (savedName) usernameInput.value = savedName;
  });

  commentForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const text = commentInput.value.trim();
    const username = usernameInput.value.trim();

    if (!text || !username) return;

    localStorage.setItem("username", username); // Save it

    await addDoc(collection(db, "comments"), {
      text,
      username,
      timestamp: serverTimestamp()
    });

    commentInput.value = "";
  });

  const q = query(collection(db, "comments"), orderBy("timestamp", "asc"));
  onSnapshot(q, (snapshot) => {
    commentList.innerHTML = "";

    snapshot.forEach((doc) => {
      const data = doc.data();
      const time = data.timestamp?.toDate().toLocaleTimeString() ?? '';
      const user = data.username || "Anonymous";

      const item = document.createElement("div");
      item.style.padding = "8px";
      item.style.margin = "5px 0";
      item.style.borderRadius = "8px";
      item.style.background = "#fff";
      item.style.boxShadow = "0 1px 3px rgba(0,0,0,0.1)";
      item.style.textAlign = "left";

      item.innerHTML = `<strong>${user}</strong> <span style="font-size: 0.8em; color: #666;">${time}</span><br>${data.text}`;
      commentList.appendChild(item);
    });

    // Auto scroll to bottom
    commentList.scrollTop = commentList.scrollHeight;
  });
  
  // REACT BUTTONS PART
  import { doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const reactionDocRef = doc(db, "reactions", "album1");

// Initialize reaction doc if not exists
async function initReactions() {
  const snap = await getDoc(reactionDocRef);
  if (!snap.exists()) {
    await setDoc(reactionDocRef, {
      adore: 0,
      meh: 0,
      bad: 0
    });
  }
}
initReactions();

// Listen for real-time updates
onSnapshot(reactionDocRef, (docSnap) => {
  const data = docSnap.data();
  document.getElementById("adoreCount").textContent = data.adore ?? 0;
  document.getElementById("mehCount").textContent = data.meh ?? 0;
  document.getElementById("badCount").textContent = data.bad ?? 0;
});

// Handlers for button clicks
document.getElementById("adoreBtn").addEventListener("click", () => {
  updateDoc(reactionDocRef, { adore: increment(1) });
});
document.getElementById("mehBtn").addEventListener("click", () => {
  updateDoc(reactionDocRef, { meh: increment(1) });
});
document.getElementById("badBtn").addEventListener("click", () => {
  updateDoc(reactionDocRef, { bad: increment(1) });
});




</script>
</body>
</html>
